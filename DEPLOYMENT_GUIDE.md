# KOSGE Berlin - Netlify Deployment Guide

## Architecture

- **Repository**: `https://github.com/CosmicSlothOracle/kosvite`
- **Platform**: Netlify (Functions + Identity)
- **Publish Directory**: `docs/`
- **Domain**: _none (using default Netlify subdomain for now)_
- **Deployment**: Direct to main branch

## Netlify Configuration

### Build Settings

```
Build command: npm --prefix netlify/functions install && python scripts/generate_chatbot_key.py && python scripts/inject_chatbot_script.py
Publish directory: docs
```

### Environment Variables

```
ADMIN_USERNAME=administroni
ADMIN_PASSWORD_HASH=[bcrypt hash from generator]
GROQ_API_KEY=[from https://console.groq.com/keys]
NODE_VERSION=18
PYTHON_VERSION=3.11
```

**Generate credentials:**

```bash
python scripts/generate_secure_credentials.py
```

### Netlify Identity

- **Enable**: Site settings → Identity → Enable Identity
- **Registration**: "Invite only"
- **Email confirmations**: Enabled

### Git Gateway

- **Enable**: Site settings → Services → Git Gateway
- **Repository**: Auto-detects `CosmicSlothOracle/kosvite`
- **Token**: GitHub Personal Access Token with `repo` + `workflow` permissions

## API Endpoints

- `/api/participants` - Participation form handling
- `/api/banners` - Banner management (auth required)

## CMS Access

- **URL**: `https://kosge-berlin.de/admin/`
- **Auth**: Netlify Identity (invite users via dashboard)

## Domain Setup (Deferred)

A custom domain will be configured later. For now the site is served at the autogenerated Netlify sub-domain (e.g. `https://<site-name>.netlify.app/`).
No `CNAME` file is needed until the custom domain is assigned.

## Deployment Flow

1. Push to main branch
2. Netlify builds automatically
3. Functions deploy to `/.netlify/functions/`
4. Site live at `https://kosge-berlin.de`

## Security Notes

- No JWT (avoiding premium features)
- Simple admin authentication via bcrypt password hash
- Environment variables stored in Netlify only
- CMS access invite-only
